\documentclass[brazil, english]{ufsc-thesis}

\usepackage[T1]{fontenc} % fontes
\usepackage[utf8]{inputenc} % UTF-8
\usepackage{lipsum} % Gerador de texto
\usepackage{pdfpages} % Inclui PDF externo (ficha catalográfica)
\usepackage{tikz} % tikz
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage[ruled,linesnumbered]{algorithm2e} % algorithms
\usepackage{tabularx} % protocol
\usepackage{hyperref}
\usepackage{listings}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Configurações da classe (dados do trabalho)                  %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\titulo{Root finding techniques in binary finite fields}
\autor{Douglas Marcelino Beppler Martins}
\data{1 de Agosto de 2019}
\instituicao{Universidade Federal de Santa Catarina}
\centro{Centro Tecnológico}
\programa{Programa de Pós-Graduação em Ciência da Computação}
\dissertacao
\local{Florianópolis}
\titulode{Mestre em Ciência da Computação}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Membros da banca (Dr. depois)                                %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\orientador{Prof. Ricardo Felipe Custódio, Dr.}
\membrobanca{Prof. Daniel Panario, Dr.}
{Carleton University}
\membrobanca{Prof. Jean Everson Martina, Dr.}
{Universidade Federal de Santa Catarina}
\membrobanca{Prof. Huifen Chan, Dr.}
{Universidade Federal de Santa Catarina}
\coordenadora{Prof. Vania Bogorny, Dr}

\DeclareMathAlphabet{\mathcal}{OMS}{cmsy}{m}{n}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Protocol environment                                         %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcounter{protocol}
\newenvironment{protocol}[1]
  {\noindent
   \tabularx{\linewidth}{@{} X @{}}
    \hline
    \vspace{-3mm}
    \refstepcounter{protocol}\hspace{7.5mm}\textbf{Protocol \theprotocol:} #1 \\
    \hline}
    {\endtabularx}

\newcommand{\sbline}{\\[.5\normalbaselineskip]}% small blank line


\newtheorem{definition}{Definition}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{example}{Example}[chapter]


\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Principais elementos pré-textuais                            %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{tex/pre_tex/pre.tex} % first page, BU and others stuffs
\input{tex/pre_tex/thanks.tex} % dedication, thanks  epigraph
\input{tex/pre_tex/abstract.tex} % resumo e abstract
\input{tex/pre_tex/lists.tex} % lists and table of contents


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Corpo do texto                                               %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textual

\chapter{Introduction}
\label{ch:intro}
\input{tex/1-intro}

\chapter{Scientific method}
\label{ch:method}
\input{tex/2-method}

\chapter{Mathematical Background}
\label{ch:math}
\input{tex/3-math}

\chapter{Code-based cryptography}
\label{ch:code-based}
\input{tex/4-code}

\chapter{Root finding techniques and countermeasures}
\label{ch:roots}
\input{tex/5-root}

\chapter{Comparison}
\label{ch:comparison}
\input{tex/6-compare}

\chapter{Final Considerations}
\label{ch:final}
\input{tex/7-final}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                   Elementos pós-textuais                     %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\postextual
\bibliography{main}

\appendix
\chapter{Implementation Code}
\begin{lstlisting}[caption={Multiplication of two elements in $\mathbb{F}_{2^{12}}$ and inversion of an element in $\mathbb{F}_{2^{12}}$},label={lst:label},language=C]

#include <stdint.h>
typedef uint16_t gf;

//Multiplication between in0 and in1
gf gf_q_m_mult(gf in0, gf in1) {
    uint64_t i, tmp, t0 = in0, t1 = in1;
    //Multiplication
    tmp = t0 * (t1 & 1);
    for (i = 1; i < 12; i++)
        tmp ^= (t0 * (t1 & (1 << i)));
    //reduction
    tmp = tmp & 0x7FFFFF;
    //first step of reduction
    gf reduction = (tmp >> 12);
    tmp = tmp & 0xFFF;
    tmp = tmp ^ (reduction << 6);
    tmp = tmp ^ (reduction << 4);
    tmp = tmp ^ reduction << 1;
    tmp = tmp ^ reduction;
    //second step of reduction
    reduction = (tmp >> 12);
    tmp = tmp ^ (reduction << 6);
    tmp = tmp ^ (reduction << 4);
    tmp = tmp ^ reduction << 1;
    tmp = tmp ^ reduction;
    tmp = tmp & 0xFFF;
    return tmp;
}

// Multiplicative inverse of in
gf gf_inv(gf in) {
    gf tmp_11 = 0;
    gf tmp_1111 = 0;
    gf out = in;
    out = gf_sq(out); //a^2
    tmp_11 = gf_mult(out, in); //a^2*a = a^3
    out = gf_sq(tmp_11); //(a^3)^2 = a^6
    out = gf_sq(out); // (a^6)^2 = a^12
    tmp_1111 = gf_mult(out, tmp_11); //a^12*a^3 = a^15
    out = gf_sq(tmp_1111); //(a^15)^2 = a^30
    out = gf_sq(out); //(a^30)^2 = a^60
    out = gf_sq(out); //(a^60)^2 = a^120
    out = gf_sq(out); //(a^120)^2 = a^240
    out = gf_mult(out, tmp_1111); //a^240*a^15 = a^255
    out = gf_sq(out); // (a^255)^2 = 510
    out = gf_sq(out); //(a^510)^2 =  1020
    out = gf_mult(out, tmp_11); //a^1020*a^3 = 1023
    out = gf_sq(out); //(a^1023)^2 = 2046
    out = gf_mult(out, in); //a^2046*a = 2047
    out = gf_sq(out); //(a^2047)^2 = 4094
    return out;
}
\end{lstlisting}

\end{document}
